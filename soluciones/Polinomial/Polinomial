import sys, json

n=0
m=0
k=0
animales = {}
apertura = []
parte=[]

def procesar_entrada(archivo):
    global n,m,k,animales, apertura, parte
    with open(archivo) as _input:
        lineas = _input.read()
    
    lineas = lineas.splitlines()
    n,m,k = int(lineas[0]), int(lineas[1]), int(lineas[2])
    
    animals = json.loads(lineas[3])
    greatness = json.loads(lineas[4])
    animales = dict(zip(animals, greatness)) # Diccionario (animal:grandeza) O(N)

    apertura = json.loads(lineas[5])
    parte = [json.loads(lineas[i]) for i in range(6, (m-1)+6)]

escenaMenorGrandeza = []
escenaMayorGrandeza = []

def ordenarEscena(array):
  for i in range(0,3):
    for j in range(i+1, 3):
      if animales[array[i]] > animales[array[j]]:
        aux = array[i]
        array[i]=array[j]
        array[j]=aux
  return array

def auxEscenas(array):
  return animales[array[0]]+animales[array[1]]+animales[array[2]]

def ordenarEscenas(array):
  for i in range(0,len(array)):
    for j in range(i+1, len(array)):
      if auxEscenas(array[i]) == auxEscenas(array[j]):
        max1 = animales[ordenarEscena(array[i])[2]]
        max2 = animales[ordenarEscena(array[j])[2]]
        if max1 > max2:
          aux = array[i]
          array[i]=array[j]
          array[j]=aux
      elif auxEscenas(array[i]) > auxEscenas(array[j]):
        aux = array[i]
        array[i]=array[j]
        array[j]=aux
  return array

def ordenarApertura():
  aux=ordenarEscenas(apertura)
  for i in range((m-1)*k):
    ordenarEscena(aux[i])
  print("Apertura:", aux, "\n")
  global escenaMenorGrandeza
  global escenaMayorGrandeza
  escenaMenorGrandeza = aux[0]
  escenaMayorGrandeza = aux[len(aux)-1]
  return escenaMayorGrandeza, escenaMenorGrandeza

def auxOrdenarPartes(array):
  aux = 0
  for i in range(0, len(array)):
    aux = aux + auxEscenas(array[i])
  return aux

def partesOrdenadas(array):
  for i in range(0,len(array)):
    for j in range(i+1, len(array)):
      if auxOrdenarPartes(array[i]) > auxOrdenarPartes(array[j]):
        aux = array[i]
        array[i]=array[j]
        array[j]=aux
  return array


def ordenarPartes():
  aux = partesOrdenadas(parte)
  for i in range(0,m-1):
    aux = ordenarEscenas(parte[i])
    for j in range(0,len(parte[i])):
      ordenarEscena(aux[j])
    print("Parte:", aux, "\n")



def zoo(archivo):
  procesar_entrada(archivo)
  ordenarApertura()
  ordenarPartes()
  #
  #
  print("La escena de menor grandeza total fue la escena", escenaMenorGrandeza, "\n")
  print("La escena de mayor grandeza total fue la escena", escenaMayorGrandeza, "\n")
  #
